1.常用命令：

df 查看磁盘分区使用状况
-l  仅显示本地磁盘(默认)
-a  显示所有文件系统的磁盘使用情况，包含比如/proc/
-h  以1024进制计算最合适的单位显示磁盘容量
-H  以1000进制计算最合适的单位显示磁盘容量
-T  显示磁盘分区类型
-t  显示指定类型文件系统的磁盘分区
-x  不显示指定类型文件系统的磁盘分区

du 统计磁盘上的文件大小
-b 以byte为单位统计文件
-k 以KB为单位统计文件
-m 以MB为单位统计文件
-h 按照1024进制以最合适的单位统计文件
-H 按照1000进制以最合适的单位统计文件
-s 指定统计目标

如：du -sk /tmp

2.分区：以命令行的方式处理。

(1)主分区和扩展分区总数不能超过4个
(2)扩展分区最多只能有一个
(3)扩展分区不能直接存取数据(建立逻辑分区)

硬盘空间消耗殆尽时怎么办?
在保留原硬盘的基础上，给服务器添加新的硬盘。

在VM虚拟机中添加硬盘：
编辑虚拟机设置->添加->硬盘->其他选项默认即可。


添加硬盘后必须分区、格式化、挂载之后才能使用。

MBR：

分区工具fdisk，查看分区信息：fdisk -l

进入分区模式：fdisk /dev/sdb
m    查看帮助命令列表  
-> 
n    添加分区
->
p(主分区)、e(扩展分区)
->
1    指定分区编号，1-4是给主分区预留的
->
指定扇区起始位置，如果直接回车表示从可用起始位置开始
->
指定扇区结束位置，+3000MB表示分配3000MB，直接回车表示分配剩余所有可用空间
->
p    可以查看已分区信息

主分区和扩展分区分好后还要分配逻辑分区：与上述分区类似。

删除分区：
d    
->
2    选择分区号

最后输入 "w" 保存分区方案。


分区模式之MBR：
主分区不能超过4个
单个分区容量最大2TB

分区模式之GPT：
主分区个数"几乎"没有限制，最多128个
单个分区容量"几乎"没有限制，最大18EB


分区工具parted，可以做MBR和GPT分区：

parted    启动parted分区工具
->
help    查看帮助信息
->
select /dev/sdc    切换分区目标硬盘
->
mklabel    给目标硬盘指定分区表的类型    mklabel msdos  MBR分区  mklabel gpt
->
print    查看分区详细信息
->    在这里可以选择询问模式和命令模式来完成分区
mkpart    添加分区
->
ABC    分区名称
->
    选择文件系统
->
1    开始位置，以MB为单位
->
2000    结束位置，以MB为单位，注意分区对齐的问题
->
print    查看分区信息
->
quit    退出分区

删除分区：
rm 分区编号(3)


分区格式化：
使用工具mkfs来分区格式化，

查看硬盘设备文件
ll /dev/sdb*

格式化并指定文件系统类型：
mkfs.ext3 /dev/sdb1
mkfs -t ext4 /dev/sdb2

MBR方式扩展分区无法格式化，GPT方式格式化后无法使用fdisk -l查看分区文件类型信息，只能使用parted工具print指令来查看。


挂载分区：分区默认的挂载目录是/mnt目录
mkdir -p /mnt/s1    创建挂载目录
mount /dev/sdb1 /mnt/s1    将sdb1挂载到s1目录下

卸载：umount 挂载目录   如：umount /mnt/s1

永久挂载：
vim + /etc/fstab    编辑配置文件
在末尾添加一行配置：
设备文件         挂载目录       文件系统类型   固定填写 固定填写  固定填写
/dev/sdb1        /mnt/s1        ext3        defaults        0        0


为硬盘添加swap交换分区：这里只有MBR方式。
(1)建立一个普通的Linux分区

按照上面的方式分区即可。

(2)修改分区类型的16进制编码

fdisk /dev/sdb
->
p    查看id(83)
->
t    修改分区类型编号
->
6    分区编号
->
L    查看16进制编码
->
82   Linux swap
->
p    查看id(82)

(3)格式化交换分区

mkswap /dev/sdb6

(4)启用交换分区

swapon  /dev/sdb6


free 查看swap分区加载状况

swapoff /dev/sdb6 停止swap分区

3.用户管理：

用户：使用操作系统的人。
用户组：具有相同系统权限的一组用户。

(1)重要配置文件：
/etc/group    存储当前系统中所有用户组信息
- Group:    x    :    123  :  abc,def,xyz
- 组名称:组密码占位符:组编号:组中用户名列表

组用户列表为空，不一定就是没有用户，如果组内只有一个用户且用户名和组名相同时，组用户列表可以省略。

root用户的组编号一定是0。

组号1-499，一般是预留给安装软件的。用户手动创建的用户组是从500开始的，一般从可用最小编号开始。


/etc/gshadow    存储当前系统中用户组的密码信息
- Group:    *    :        :  abc,def,xyz
- 组名称:组密码:组管理者:组中用户名列表

如果组密码是 * ！ 或者 空，那么可以认为组密码为空。


/etc/passwd    存储当前系统中所有用户的信息
- user  :  x  :  123  :  456  :  xxxxxxxx  :  /home/user  :  /bin/bash
- 用户组:密码占位符:用户编号:用户组编号:用户注释信息:用户主目录:shell类型


/etc/shadow    存储当前系统中所有用户的密码信息
- user :  vf;/Zu8sdf...:::::
- 用户名:  密码  :::::

这里的密码是被加密过的。  

(2)用户和用户组基本命令：

添加用户组：

groupadd 组名称

修改用户组名称：

groupmod -n 新组名 旧组名

修改用户组编号：

groupmod -g 新组编号 组名称

创建用户组的同时指定用户组编号：

groupadd -g 组编号 组名称

删除用户组：删除用户组之前必须删除用户组中的用户

groupdel 组名称

添加用户：这种方式默认在/home目录下添加用户同名目录作为家目录，系统会默认创建和用户名相同的用户组。

useradd -g 组名 用户名

添加用户同时指定用户家目录：

useradd -d /home/user1 用户名

给用户添加备注：

usermod -c 备注 用户名

修改用户名：

usermod -l 新用户名 旧用户名

修改个人文件夹：

usermod -d /home/user1 用户名

修改用户所属组：

usermod -g 目标组名 用户名

删除用户：

userdel 用户名

删除用户时一起删除个人文件夹：

userdel -r 用户名

暂时禁止普通用户登录服务器：在etc目录下创建nologin空文件

touch /etc/nologin

(3)用户和用户组进阶命令：

给用户设置密码：

passwd 用户密码

锁定账户：

passwd -l 用户名

解锁账户：

passwd -u 用户名

清除账户密码：

passwd -d 用户名


主要组和附属组：

用户可以同时属于多个组，一个主要组和多个附属组。

添加附属组：

gpasswd -a 用户名 附属组名

一次性将用户添加到多个附属组中可以用逗号将附属组名链接起来。

用户创建的文件默认属于主要组，如果想以附属组员的身份创建文件则需要临时切换到附属组身份，

newgrp 附属用户组名 [组密码]

删除附属组：

gpasswd -d 用户名 附属组名

添加用户时，同时设定主要组和附属组：

useradd -g group1 -G group2,group3

设定组密码：

gpasswd 组名称

(3)其他命令：

切换用户身份：su username

如果su后不跟用户名称，则表示切换到root用户。普通用户切换时需要密码，root用户切换到普通用户时不需要密码。

Whoami：显示当前登录名

id 用户名：显示指定用户信息

groups 用户名：显示用户所有组

chfn 用户名：设置用户资料，依次输入用户资料

finger 用户名：显示用户详细资料(CentOS不支持)










































